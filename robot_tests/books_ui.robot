*** Settings ***
Documentation     Books Service UI Test Suite
...
...               This test suite validates the Books Service user interface functionality
...               including page load, search, display, and user interactions.
...
...               Test Strategy:
...               - Read-only operations (no data modification)
...               - Uses Gherkin syntax (Given/When/Then)
...               - Follows Page Object Model pattern
...               - Uses explicit waits (NO Sleep)
...
...               Source: Generated by Claude Code following RF 7.4.1 standards
...               Version: robotframework==7.4.1, robotframework-browser==19.12.3

Resource          resources/common.resource
Resource          resources/pages/BooksPage.resource

Suite Setup       Initialize UI Test Suite
Suite Teardown    Cleanup UI Test Suite
Test Setup        Setup Individual UI Test
Test Teardown     Teardown Individual UI Test

Force Tags        ui    books    browser
Default Tags      smoke


*** Variables ***
${SEARCH_TERM_VALID}      Hero
${SEARCH_TERM_COMMON}     the
${SEARCH_TERM_INVALID}    XYZNONEXISTENT123


*** Test Cases ***
User Should Be Able To View Books Catalog Page
    [Documentation]    Verify user can access and view the Books catalog page
    ...
    ...                Steps:
    ...                1. Open browser and navigate to Books page
    ...                2. Verify page loads successfully
    ...                3. Verify books are displayed
    ...
    ...                Expected: Page loads and displays book catalog
    [Tags]    catalog    positive    priority-high

    Given User Opens Books Catalog Page
    Then Books Catalog Should Be Displayed
    And Multiple Books Should Be Visible

User Should Be Able To Search For Books
    [Documentation]    Verify user can search for books using search functionality
    ...
    ...                Steps:
    ...                1. Navigate to Books page
    ...                2. Enter search term in search field
    ...                3. Submit search
    ...                4. Verify results are displayed
    ...
    ...                Expected: Search results match search term
    [Tags]    search    positive    priority-high

    Given User Opens Books Catalog Page
    When User Searches For Books With Term    ${SEARCH_TERM_VALID}
    Then Search Results Should Be Displayed
    And Search Results Should Match Term    ${SEARCH_TERM_VALID}

User Should See All Books When No Search Term Entered
    [Documentation]    Verify default view shows all books without filter
    ...
    ...                Expected: All books are visible on page load
    [Tags]    catalog    positive    priority-medium

    Given User Opens Books Catalog Page
    Then Books Catalog Should Be Displayed
    And Books List Should Not Be Empty

User Should See Book Details On Cards
    [Documentation]    Verify book cards display required information
    ...
    ...                Validates that each book card shows:
    ...                - Book title
    ...                - Author name
    ...
    ...                Expected: Book cards contain complete information
    [Tags]    display    positive    priority-high

    Given User Opens Books Catalog Page
    When User Views First Book Card
    Then Book Card Should Display Title
    And Book Card Should Display Author

User Should See Message When No Books Match Search
    [Documentation]    Verify appropriate message when search returns no results
    ...
    ...                Steps:
    ...                1. Search with non-existent term
    ...                2. Verify no books are displayed
    ...                3. Verify empty state message appears
    ...
    ...                Expected: User-friendly "no results" message
    [Tags]    search    negative    priority-medium

    Given User Opens Books Catalog Page
    When User Searches For Books With Term    ${SEARCH_TERM_INVALID}
    Then No Search Results Should Be Displayed

User Should Be Able To View Multiple Books In Catalog
    [Documentation]    Verify catalog displays multiple books simultaneously
    ...
    ...                Validates that:
    ...                - Multiple book cards are rendered
    ...                - Each card is distinct and visible
    ...                - Minimum threshold of books is met
    ...
    ...                Expected: At least 10 books visible in catalog
    [Tags]    catalog    display    positive    priority-medium

    Given User Opens Books Catalog Page
    Then Books Catalog Should Be Displayed
    And At Least Books Should Be Visible    10

User Should See Responsive Page Layout
    [Documentation]    Verify page layout is rendered correctly
    ...
    ...                Checks:
    ...                - Page structure is intact
    ...                - Main content area is visible
    ...                - Interactive elements are accessible
    ...
    ...                Expected: Page is fully functional and responsive
    [Tags]    ui    layout    positive    priority-low

    Given User Opens Books Catalog Page
    Then Page Layout Should Be Responsive
    And Page Should Be Interactive


*** Keywords ***
# Given Keywords (Preconditions)
Given User Opens Books Catalog Page
    [Documentation]    Precondition: User navigates to Books catalog page

    Initialize Browser Environment
    Open Books Page

# When Keywords (Actions)
When User Searches For Books With Term
    [Documentation]    Action: User performs search operation
    [Arguments]    ${search_term}

    Search For Books    ${search_term}

When User Views First Book Card
    [Documentation]    Action: User examines first book card on page

    @{cards}=    Get All Book Cards
    ${first_card}=    Set Variable    ${cards}[0]
    Set Test Variable    ${CURRENT_CARD}    ${first_card}

# Then Keywords (Verifications)
Then Books Catalog Should Be Displayed
    [Documentation]    Verification: Books catalog page is visible

    Verify Books Page Loaded
    Verify Books Page Is Responsive

Then Multiple Books Should Be Visible
    [Documentation]    Verification: More than one book is displayed

    ${count}=    Get Book Card Count
    Should Be True    ${count} > 1    msg=Expected multiple books, found ${count}

Then Search Results Should Be Displayed
    [Documentation]    Verification: Search results are visible

    ${count}=    Get Book Card Count
    Should Be True    ${count} >= 0    msg=Search results not displayed

Then Search Results Should Match Term
    [Documentation]    Verification: Results contain search term
    [Arguments]    ${search_term}

    Verify Search Results Match Term    ${search_term}

Then Books List Should Not Be Empty
    [Documentation]    Verification: At least one book is displayed

    Verify Minimum Book Count    ${1}

Then Book Card Should Display Title
    [Documentation]    Verification: Book card shows title

    ${title}=    Get Book Title From Card    ${CURRENT_CARD}
    Should Not Be Empty    ${title}    msg=Book title is empty

Then Book Card Should Display Author
    [Documentation]    Verification: Book card shows author

    ${author}=    Get Book Author From Card    ${CURRENT_CARD}
    Should Not Be Empty    ${author}    msg=Book author is empty

Then No Search Results Should Be Displayed
    [Documentation]    Verification: No books match search criteria

    TRY
        Verify No Books Found Message
        Log    No results message displayed correctly
    EXCEPT
        # Alternative: Verify zero books displayed
        ${count}=    Get Book Card Count
        Should Be Equal As Integers    ${count}    0    msg=Expected no results
    END

Then At Least Books Should Be Visible
    [Documentation]    Verification: Minimum book count threshold
    [Arguments]    ${minimum}

    ${min_int}=    Convert To Integer    ${minimum}
    Verify Minimum Book Count    ${min_int}

Then Page Layout Should Be Responsive
    [Documentation]    Verification: Page layout renders correctly

    Verify Books Page Is Responsive

Then Page Should Be Interactive
    [Documentation]    Verification: Page elements are interactive

    ${url}=    Get Url
    Should Contain    ${url}    ${BASE_URL}

    # Verify page is not frozen
    ${title}=    Get Title
    Should Not Be Empty    ${title}

# And Keywords (Additional Verifications)
And Multiple Books Should Be Visible
    [Documentation]    Additional verification: Multiple books displayed

    Then Multiple Books Should Be Visible

And Search Results Should Match Term
    [Documentation]    Additional verification: Results match search
    [Arguments]    ${search_term}

    Then Search Results Should Match Term    ${search_term}

And Books List Should Not Be Empty
    [Documentation]    Additional verification: Books list has content

    Then Books List Should Not Be Empty

And Book Card Should Display Title
    [Documentation]    Additional verification: Title is displayed

    Then Book Card Should Display Title

And Book Card Should Display Author
    [Documentation]    Additional verification: Author is displayed

    Then Book Card Should Display Author

And At Least Books Should Be Visible
    [Documentation]    Additional verification: Minimum book count
    [Arguments]    ${minimum}

    Then At Least Books Should Be Visible    ${minimum}

And Page Should Be Interactive
    [Documentation]    Additional verification: Page interactivity

    Then Page Should Be Interactive

# Suite Lifecycle Keywords
Initialize UI Test Suite
    [Documentation]    Setup for entire UI test suite
    ...                Initializes test environment and configurations

    Log    Starting UI Test Suite: Books Service
    Initialize Test Environment
    Log    UI Test Suite initialized successfully

Cleanup UI Test Suite
    [Documentation]    Cleanup after entire UI test suite
    ...                Closes browsers and cleans up resources

    Log    Cleaning up UI Test Suite
    Cleanup Test Environment
    Log    UI Test Suite cleanup completed

# Test Lifecycle Keywords
Setup Individual UI Test
    [Documentation]    Setup for individual UI test case
    ...                Prepares clean browser state for each test

    Log    Starting test: ${TEST_NAME}

Teardown Individual UI Test
    [Documentation]    Cleanup after individual UI test case
    ...                Captures screenshot on failure and closes pages

    IF    '${TEST_STATUS}' == 'FAIL'
        Log    Test failed: ${TEST_NAME}
        Take Screenshot On Failure
    END

    # Close current page to ensure clean state
    TRY
        Close Page
    EXCEPT
        Log    No page to close    level=DEBUG
    END

    Log    Test completed: ${TEST_NAME}
